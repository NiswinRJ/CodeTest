¥
6D:\CodeReview\CodeTest\UserBehaviourService\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. 
AddDbContext 
< 
AppDbContext *
>* +
(+ ,
options, 3
=>4 6
options 
. 
UseMySql 
( 
builder 
. 
Configuration *
.* +
GetConnectionString+ >
(> ?
$str? R
)R S
,S T
new 
MySqlServerVersion 
( 
new "
Version# *
(* +
$num+ ,
,, -
$num. /
,/ 0
$num1 3
)3 4
)4 5
)5 6
)6 7
;7 8
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
)  
;  !
builder 
. 
Services 
. 
AddCors 
( 
options  
=>! #
{ 
options 
. 
	AddPolicy 
( 
$str #
,# $
builder 
=> 
builder 
. 
WithOrigins &
(& '
$str' >
)> ?
. 
AllowAnyHeader )
() *
)* +
. 
AllowAnyMethod )
() *
)* +
)+ ,
;, -
} 
) 
; 
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
if"" 
("" 
app"" 
."" 
Environment"" 
."" 
IsDevelopment"" !
(""! "
)""" #
)""# $
{## 
app$$ 
.$$ 

UseSwagger$$ 
($$ 
)$$ 
;$$ 
app%% 
.%% 
UseSwaggerUI%% 
(%% 
)%% 
;%% 
}&& 
app(( 
.(( 
UseHttpsRedirection(( 
((( 
)(( 
;(( 
app)) 
.)) 
UseCors)) 
()) 
$str)) 
))) 
;)) 
app++ 
.++ 
UseAuthorization++ 
(++ 
)++ 
;++ 
app-- 
.-- 
MapControllers-- 
(-- 
)-- 
;-- 
app// 
.// 
Run// 
(// 
)// 	
;//	 
‡
:D:\CodeReview\CodeTest\UserBehaviourService\Models\User.cs
	namespace 	
UserBehaviourAPI
 
. 
Models !
{ 
public 

class 
User 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public		 
string		 
Email		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
public

 
string

 
ContentType

 !
{

" #
get

$ '
;

' (
set

) ,
;

, -
}

. /
public 
DateTime 
JoiningDate #
{$ %
get& )
;) *
set+ .
;. /
}0 1
} 
} – 
TD:\CodeReview\CodeTest\UserBehaviourService\Migrations\20250710052857_FirstCreate.cs
	namespace 	 
UserBehaviourService
 
. 

Migrations )
{ 
public

 

partial

 
class

 
FirstCreate

 $
:

% &
	Migration

' 0
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
AlterDatabase *
(* +
)+ ,
. 

Annotation 
( 
$str +
,+ ,
$str- 6
)6 7
;7 8
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str 
, 
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 6
,6 7
nullable8 @
:@ A
falseB G
)G H
. 

Annotation #
(# $
$str$ C
,C D(
MySqlValueGenerationStrategyE a
.a b
IdentityColumnb p
)p q
,q r
Name 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 D
,D E
	maxLengthF O
:O P
$numQ T
,T U
nullableV ^
:^ _
false` e
)e f
. 

Annotation #
(# $
$str$ 3
,3 4
$str5 >
)> ?
,? @
Email 
= 
table !
.! "
Column" (
<( )
string) /
>/ 0
(0 1
type1 5
:5 6
$str7 E
,E F
	maxLengthG P
:P Q
$numR U
,U V
nullableW _
:_ `
falsea f
)f g
. 

Annotation #
(# $
$str$ 3
,3 4
$str5 >
)> ?
,? @
ContentType 
=  !
table" '
.' (
Column( .
<. /
string/ 5
>5 6
(6 7
type7 ;
:; <
$str= G
,G H
nullableI Q
:Q R
falseS X
)X Y
. 

Annotation #
(# $
$str$ 3
,3 4
$str5 >
)> ?
,? @
JoiningDate 
=  !
table" '
.' (
Column( .
<. /
DateTime/ 7
>7 8
(8 9
type9 =
:= >
$str? L
,L M
nullableN V
:V W
falseX ]
)] ^
} 
, 
constraints   
:   
table   "
=>  # %
{!! 
table"" 
."" 

PrimaryKey"" $
(""$ %
$str""% /
,""/ 0
x""1 2
=>""3 5
x""6 7
.""7 8
Id""8 :
)"": ;
;""; <
}## 
)## 
.$$ 

Annotation$$ 
($$ 
$str$$ +
,$$+ ,
$str$$- 6
)$$6 7
;$$7 8
}%% 	
	protected(( 
override(( 
void(( 
Down((  $
((($ %
MigrationBuilder((% 5
migrationBuilder((6 F
)((F G
{)) 	
migrationBuilder** 
.** 
	DropTable** &
(**& '
name++ 
:++ 
$str++ 
)++ 
;++ 
},, 	
}-- 
}.. Œ
@D:\CodeReview\CodeTest\UserBehaviourService\Data\AppDbContext.cs
	namespace 	
UserBehaviourAPI
 
. 
Data 
{ 
public 

class 
AppDbContext 
: 
	DbContext  )
{ 
public 
AppDbContext 
( 
DbContextOptions ,
<, -
AppDbContext- 9
>9 :
options; B
)B C
:		 
base		 
(		 
options		 
)		 
{

 	
} 	
public 
DbSet 
< 
User 
> 
Users  
{! "
get# &
;& '
set( +
;+ ,
}- .
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
modelBuilder= I
)I J
{ 	
base 
. 
OnModelCreating  
(  !
modelBuilder! -
)- .
;. /
modelBuilder 
. 
Entity 
<  
User  $
>$ %
(% &
)& '
. 
Property 
( 
u 
=> 
u  
.  !
Name! %
)% &
. 

IsRequired 
( 
) 
. 
HasMaxLength 
( 
$num !
)! "
;" #
modelBuilder 
. 
Entity 
<  
User  $
>$ %
(% &
)& '
. 
Property 
( 
u 
=> 
u  
.  !
Email! &
)& '
. 

IsRequired 
( 
) 
. 
HasMaxLength 
( 
$num !
)! "
;" #
} 	
} 
}   ™F
ID:\CodeReview\CodeTest\UserBehaviourService\Controllers\UserController.cs
	namespace 	
UserBehaviour
 
. 
Controllers #
{ 
[		 
ApiController		 
]		 
[

 
Route

 

(


 
$str

 
)

 
]

 
public 

class 
UserController 
:  !
ControllerBase" 0
{ 
private 
readonly 
AppDbContext %
_context& .
;. /
public 
UserController 
( 
AppDbContext *
context+ 2
)2 3
{ 	
_context 
= 
context 
; 
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetAllUsers) 4
(4 5
)5 6
{ 	
var 
users 
= 
await 
_context &
.& '
Users' ,
. 
AsNoTracking 
( 
) 
. 
ToListAsync 
( 
) 
; 
return 
Ok 
( 
users 
) 
; 
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public   
async   
Task   
<   
IActionResult   '
>  ' (
GetUserById  ) 4
(  4 5
int  5 8
id  9 ;
)  ; <
{!! 	
var"" 
user"" 
="" 
await"" 
_context"" %
.""% &
Users""& +
.## 
AsNoTracking## 
(## 
)## 
.$$ 
FirstOrDefaultAsync$$ $
($$$ %
u$$% &
=>$$' )
u$$* +
.$$+ ,
Id$$, .
==$$/ 1
id$$2 4
)$$4 5
;$$5 6
if%% 
(%% 
user%% 
==%% 
null%% 
)%% 
return&& 
NotFound&& 
(&&  
)&&  !
;&&! "
return'' 
Ok'' 
('' 
user'' 
)'' 
;'' 
}(( 	
[++ 	
HttpPost++	 
]++ 
public,, 
async,, 
Task,, 
<,, 
IActionResult,, '
>,,' (

CreateUser,,) 3
(,,3 4
[,,4 5
FromBody,,5 =
],,= >
User,,? C
user,,D H
),,H I
{-- 	
if.. 
(.. 
!.. 

ModelState.. 
... 
IsValid.. #
)..# $
return// 

BadRequest// !
(//! "

ModelState//" ,
)//, -
;//- .
_context11 
.11 
Users11 
.11 
Add11 
(11 
user11 #
)11# $
;11$ %
await22 
_context22 
.22 
SaveChangesAsync22 +
(22+ ,
)22, -
;22- .
return44 
CreatedAtAction44 "
(44" #
nameof44# )
(44) *
GetUserById44* 5
)445 6
,446 7
new448 ;
{44< =
id44> @
=44A B
user44C G
.44G H
Id44H J
}44K L
,44L M
user44N R
)44R S
;44S T
}55 	
[88 	
HttpPut88	 
(88 
$str88 
)88 
]88 
public99 
async99 
Task99 
<99 
IActionResult99 '
>99' (

UpdateUser99) 3
(993 4
int994 7
id998 :
,99: ;
[99< =
FromBody99= E
]99E F
User99G K
user99L P
)99P Q
{:: 	
if;; 
(;; 
id;; 
!=;; 
user;; 
.;; 
Id;; 
);; 
return<< 

BadRequest<< !
(<<! "
$str<<" 4
)<<4 5
;<<5 6
if>> 
(>> 
!>> 

ModelState>> 
.>> 
IsValid>> #
)>># $
return?? 

BadRequest?? !
(??! "

ModelState??" ,
)??, -
;??- .
varAA 
existingUserAA 
=AA 
awaitAA $
_contextAA% -
.AA- .
UsersAA. 3
.AA3 4
	FindAsyncAA4 =
(AA= >
idAA> @
)AA@ A
;AAA B
ifBB 
(BB 
existingUserBB 
==BB 
nullBB  $
)BB$ %
returnCC 
NotFoundCC 
(CC  
)CC  !
;CC! "
existingUserEE 
.EE 
NameEE 
=EE 
userEE  $
.EE$ %
NameEE% )
;EE) *
existingUserFF 
.FF 
EmailFF 
=FF  
userFF! %
.FF% &
EmailFF& +
;FF+ ,
existingUserGG 
.GG 
ContentTypeGG $
=GG% &
userGG' +
.GG+ ,
ContentTypeGG, 7
;GG7 8
existingUserHH 
.HH 
JoiningDateHH $
=HH% &
userHH' +
.HH+ ,
JoiningDateHH, 7
;HH7 8
awaitJJ 
_contextJJ 
.JJ 
SaveChangesAsyncJJ +
(JJ+ ,
)JJ, -
;JJ- .
returnKK 
	NoContentKK 
(KK 
)KK 
;KK 
}LL 	
[OO 	

HttpDeleteOO	 
(OO 
$strOO 
)OO 
]OO 
publicPP 
asyncPP 
TaskPP 
<PP 
IActionResultPP '
>PP' (

DeleteUserPP) 3
(PP3 4
intPP4 7
idPP8 :
)PP: ;
{QQ 	
varRR 
userRR 
=RR 
awaitRR 
_contextRR %
.RR% &
UsersRR& +
.RR+ ,
	FindAsyncRR, 5
(RR5 6
idRR6 8
)RR8 9
;RR9 :
ifSS 
(SS 
userSS 
==SS 
nullSS 
)SS 
returnTT 
NotFoundTT 
(TT  
)TT  !
;TT! "
_contextVV 
.VV 
UsersVV 
.VV 
RemoveVV !
(VV! "
userVV" &
)VV& '
;VV' (
awaitWW 
_contextWW 
.WW 
SaveChangesAsyncWW +
(WW+ ,
)WW, -
;WW- .
returnXX 
	NoContentXX 
(XX 
)XX 
;XX 
}YY 	
[\\ 	
HttpGet\\	 
(\\ 
$str\\ 
)\\ 
]\\ 
public]] 
async]] 
Task]] 
<]] 
IActionResult]] '
>]]' (
SearchUsers]]) 4
(]]4 5
[]]5 6
	FromQuery]]6 ?
]]]? @
string]]A G
term]]H L
)]]L M
{^^ 	
var__ 
users__ 
=__ 
await__ 
_context__ &
.__& '
Users__' ,
.`` 
AsNoTracking`` 
(`` 
)`` 
.aa 
Whereaa 
(aa 
uaa 
=>aa 
uaa 
.aa 
Nameaa "
.aa" #
Containsaa# +
(aa+ ,
termaa, 0
)aa0 1
||aa2 4
uaa5 6
.aa6 7
Emailaa7 <
.aa< =
Containsaa= E
(aaE F
termaaF J
)aaJ K
)aaK L
.bb 
ToListAsyncbb 
(bb 
)bb 
;bb 
returndd 
Okdd 
(dd 
usersdd 
)dd 
;dd 
}ee 	
[hh 	
HttpGethh	 
(hh 
$strhh ,
)hh, -
]hh- .
publicii 
asyncii 
Taskii 
<ii 
IActionResultii '
>ii' (!
GetUsersByContentTypeii) >
(ii> ?
stringii? E
contenttypeiiF Q
)iiQ R
{jj 	
varkk 
userskk 
=kk 
awaitkk 
_contextkk &
.kk& '
Userskk' ,
.ll 
AsNoTrackingll 
(ll 
)ll 
.mm 
Wheremm 
(mm 
umm 
=>mm 
umm 
.mm 
ContentTypemm )
==mm* ,
contenttypemm- 8
)mm8 9
.nn 
ToListAsyncnn 
(nn 
)nn 
;nn 
returnpp 
Okpp 
(pp 
userspp 
)pp 
;pp 
}qq 	
}rr 
}ss 